###
 # @Author: linin00
 # @Date: 2022-06-12 05:09:53
 # @LastEditTime: 2022-06-12 05:42:26
 # @LastEditors: linin00
 # @Description: 
 # @FilePath: /easy/zsh/config.sh
 # 天道酬勤
### 

# step 1: 安装zsh
sudo apt install -y zsh > /dev/null
if [[ $? -ne 0 ]]; then
    echo "ERROR: Failed to install zsh." >&2
    return 1
fi

# step 2: 配置zsh
sh ./utils/oh_my_zsh.sh > /dev/null 2>&1
code=$?
if [[ $code -ne 0 ]]; then
    if [[ $code -eq 1 ]]; then
        echo "WARNING: oh_my_zsh already exists"
    else
        echo "ERROR: Failed to config oh_my_zsh." >&2
        return 2
    fi
fi
# step 3: 安装插件，以下插件均已在vimrc中配置好，如果要额外添加插件需要手动在vimrc中加上

## 只需要输入部分命令即可根据之前输入过的命令提示，按右方向键即可补全
git clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions > /dev/null 2>&1
code=$?
if [[ $code -ne 0 ]]; then
    if [[ $code -eq 128 ]]; then
        echo "WARNING: zsh-syntax-highlighting already exists and is not an empty directory"
    else
        echo "ERROR: Failed to clone zsh-autosuggestions." >&2
        return 3
    fi
fi

## 语法高亮，输入正确的语法会显示绿色，否则会显示红色，不用执行就可以知道命令语法是否正确
git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting > /dev/null 2>&1
code=$?
if [[ $code -ne 0 ]]; then
    if [[ $code -eq 128 ]]; then
        echo "WARNING: zsh-syntax-highlighting already exists and is not an empty directory"
    else
        echo "ERROR: Failed to clone zsh-syntax-highlighting." >&2
        return 4
    fi
fi

# step 4: 配置环境
cp ~/.zshrc ~/.zshrc_backup
cp ./utils/zshrc ~/.zshrc
exec zsh -l
